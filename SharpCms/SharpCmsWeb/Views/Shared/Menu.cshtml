@using SharpCms.Core.DataObjects
@model PageInfo
@{
    var rootpage = Model.Children.FirstOrDefault(x => x.NavState == NavState.OPEN && x.UrlName == ViewContext.RouteData.Values["page1"].ToString());
    var path = String.Empty;
    var rootpath = "/" + rootpage.UrlName;
    
}

<ul>
    @foreach (var page1 in rootpage.Children.Where(x => x.NavState == NavState.OPEN))
    {
        path = rootpath + "/" + page1.UrlName;
        <li>
            <a href="@path">@page1.Menuname</a>
            @if (page1.Children != null)
            {
                <ul>
                    @foreach (var page2 in page1.Children.Where(x => x.NavState == NavState.OPEN))
                    {
                        path = rootpath + "/" + page1.UrlName + "/" + page2.UrlName;
                        <li>
                            <a href="@path">@page2.Menuname</a>
                            @if (page2.Children != null)
                            {
                                <ul>
                                    @foreach (var page3 in page2.Children.Where(x => x.NavState == NavState.OPEN))
                                    {
                                        path = rootpath + "/" + page1.UrlName + "/" + page2.UrlName + "/" + page3.UrlName;
                                        <li>
                                            <a href="@path">@page3.Menuname</a>
                                        </li>
                                    }
                                </ul>
                            }
                        </li>
                    }
                </ul>
            }
        </li>
    }
</ul>
